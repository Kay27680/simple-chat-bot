from flask import Flask, request, jsonify

app = Flask(__name__)

# Predefined responses for the chatbot
responses = {
    "greeting": ["Hi! How can I assist you today?", "Hello! What can I help you with?"],
    "hours": ["We are open from 9 AM to 6 PM, Monday to Friday."],
    "location": ["Our office is located at 123 Main Street, Cityville."],
    "contact": ["You can reach us at support@example.com or call us at +123456789."],
    "human": ["Let me connect you to a human agent. Please wait a moment."],
    "fallback": ["I'm sorry, I didn't understand that. Can you please rephrase?"]
}


def get_response(message):
    """
    Basic keyword matching to generate chatbot responses.
    """
    message = message.lower()
    if any(word in message for word in ["hi", "hello", "hey"]):
        return responses["greeting"][0]
    elif "hours" in message or "open" in message:
        return responses["hours"][0]
    elif "location" in message or "where" in message:
        return responses["location"][0]
    elif "contact" in message or "email" in message or "phone" in message:
        return responses["contact"][0]
    elif "human" in message or "agent" in message:
        return responses["human"][0]
    else:
        return responses["fallback"][0]


@app.route('/chat', methods=['POST'])
def chat():
    """
    API endpoint for chatting with the chatbot.
    """
    data = request.json
    user_message = data.get("message", "")
    if not user_message:
        return jsonify({"response": "Please send a valid message."}), 400

    # Get a response from the chatbot
    bot_response = get_response(user_message)

    return jsonify({"response": bot_response})


if __name__ == '__main__':
    app.run(port=5000, debug=True)
